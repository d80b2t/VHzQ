# qsoName,filterID,mjd,duration,aperJky3,aperJky3Err,aperMag3Ab,aperMag3Err,ppErrBits,nMeas,totExpTime
#
# Results of Query: Database WSERV1000v20181217 12/02/19 09:36
# SELECT qso.qsoName,aver.filterID,AVG(m.mjdObs) as mjd, 
# (MAX(m.mjdObs)-MIN(m.mjdObs)) as duration, aver.aperJky3, 
# aver.aperJky3Err,(aver.aperMag3+f.VegaToAB) as aperMag3Ab,
# aver.aperMag3Err, aver.ppErrBits, COUNT(mfs.catalogueID) as nMeas,
# SUM(d.totalExpTime) as totExpTime   /* In this selection we have 
# included the average mjdObs (averaged   over all frames in a 30 day 
# period) and the duration (the mjd of the   last frame in the period 
# minus that of the first), the number of   frames (nMeas) and the sum 
# of the integration times. We have also   included the calibrated 
# fluxes (aperJky3), since in many cases the a   faint source may have 
# very low S/N */ FROM finalQsoCatalogue as qso,
# MapApertureIDshighzQsoMap as ma, wserv1000MapRemeasAver as aver,
# MapProvenance as mp, MapFrameStatus as mfs,MultiframeDetector as d,
# Multiframe as m,Filter as f, wserv1000MapRemeasurement as remeas   /* 
# The tables to select from include MapProvenance to select the   
# correct averaging time scale and to get the frames used in each   
# average catalogue. Also include MultiframeDetector to get the   
# integration time. */ WHERE qso.qsoID=ma.objectID and 
# ma.apertureID=aver.apertureID and mp.combiCatID=aver.catalogueID and 
# mp.avSetupID=3 and    /* Do joins and select avSetupID=3 --> average 
# over 30 days. Other   avSetupID values can be used to change the 
# averaging timescale */ mp.catalogueID=mfs.catalogueID and 
# d.multiframeID=mfs.multiframeID and 
# mfs.catalogueID=remeas.catalogueID and 
# remeas.apertureID=aver.apertureID and remeas.extNum=d.extNum and 
# qsoID=121 and f.filterID=d.filterID and m.multiframeID=d.multiframeID 
#   /* Select qsoID=54 */  GROUP BY qso.qsoName,aver.filterID, 
# aver.aperJky3,aver.aperJky3Err, aver.aperMag3,aver.aperMag3Err,
# aver.ppErrBits,f.VegaToAB   /* GROUP BY attributes that are part of 
# are associated with the   average so that we get statistics for 
# properties measured at the   frame level */
# Column Headers at start of file AND below
#
# qsoName,filterID,mjd,duration,aperJky3,aperJky3Err,aperMag3Ab,aperMag3Err,ppErrBits,nMeas,totExpTime
                  SDSSJ0836+0054,   1,  +5.5222387E004,      +0.0655900,     +0.000106,+4.290054E-007,    +18.823292,     +0.004396,          0,         12,   +4320.0000000
                  SDSSJ0836+0054,   2,  +5.4080556E004,  +0.0000000E000,+9.957752E-005,+2.429698E-006,    +18.887598,     +0.026492,          0,          1,     +40.0000000
                  SDSSJ0836+0054,   2,  +5.5221380E004,      +0.0841100,+9.995210E-005,+4.767614E-007,    +18.883520,     +0.005179,          0,          8,   +2880.0000000
                  SDSSJ0836+0054,   3,  +5.5947512E004,  +0.0000000E000,     +0.000124,+2.773134E-006,    +18.650446,     +0.024349,          0,          1,     +40.0000000
                  SDSSJ0836+0054,   3,  +5.5219970E004,      +0.9976800,     +0.000126,+3.424065E-007,    +18.630926,     +0.002953,          0,         20,   +7200.0000000
                  SDSSJ0836+0054,   3,  +5.4076609E004,  +0.0000000E000,     +0.000128,+2.794345E-006,    +18.611362,     +0.023667,          0,          1,     +40.0000000
                  SDSSJ0836+0054,   4,  +5.4076636E004,  +0.0000000E000,     +0.000158,+3.358628E-006,    +18.401804,     +0.023047,          0,          1,     +40.0000000
                  SDSSJ0836+0054,   5,  +5.4078578E004,  +0.0000000E000,     +0.000212,+4.831214E-006,    +18.084196,     +0.024743,          0,          1,     +40.0000000
